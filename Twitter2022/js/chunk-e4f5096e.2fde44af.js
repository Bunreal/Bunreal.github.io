(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e4f5096e"],{b30c:function(e,o,t){"use strict";t("e52f")},ca9b:function(e,o,t){},e52f:function(e,o,t){},ea4c:function(e,o,t){"use strict";t("ca9b")},ee09:function(e,o,t){"use strict";t.r(o);var n=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"wrap"},[t("navigation",{attrs:{userId:e.currentUser.id}}),t("div",{staticClass:"main"},[t("userTitle",{attrs:{userName:e.user.name,tweetNum:e.user.tweetsCount}}),t("navTabsFollow",{attrs:{userId:Number(e.$route.params.id)}}),t("div",{staticClass:"tweet-wrap"},e._l(e.followships,(function(o){return t("div",{key:o.id,staticClass:"tweet-card"},[t("div",{staticClass:"tweet-avatar"},[t("img",{attrs:{src:e._f("emptyAvatar")(o.followingUser.avatar),alt:""}})]),t("div",{staticClass:"tweet-content"},[t("div",{staticClass:"tweet-title"},[t("div",{staticClass:"tweet-name-group"},[t("p",{staticClass:"tweet-name"},[t("b",[e._v(e._s(o.followingUser.name))])]),o.isFollowed?t("div",{staticClass:"btn active",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.unFollow(o.followingId)}}},[e._v("正在跟隨")]):t("div",{staticClass:"btn",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.addFollow(o.followingId)}}},[e._v("跟隨")])])]),t("div",{staticClass:"tweet-text"},[t("p",[e._v(" "+e._s(o.followingUser.introduction)+" ")])])])])})),0)],1),t("followTopTypeB",{key:e.componentKey,on:{"addFollow-From-followTop":e.addFollowFromfollowTop,"unFollow-From-followTop":e.unFollowFromfollowTop}})],1)},r=[],a=t("5530"),l=t("2909"),i=t("1da1"),s=(t("96cf"),t("b0c0"),t("d81d"),t("7db0"),t("d3b7"),t("3d01")),c=t("7e59"),u=t("8e6e"),w=t("477d"),f=t("2708"),d=t("1602"),p=t("2f62"),h=t("2fa3"),v=t("b025"),m={name:"selfPageFollowing",components:{navigation:s["a"],followTopTypeB:c["a"],userTitle:u["a"],navTabsFollow:w["a"]},data:function(){return{user:{name:"",tweetNum:-1},followships:[],componentKey:0}},methods:{fetchUser:function(e){var o=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,l,i,s,c,u,w,f,p,h,v,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d["a"].getUser(e);case 3:n=t.sent,r=n.data,a=r.id,l=r.account,i=r.name,s=r.email,c=r.role,u=r.introduction,w=r.avatar,f=r.cover,p=r.followingCount,h=r.followerCount,v=r.isFollowing,m=r.tweetsCount,o.user={id:a,account:l,name:i,email:s,role:c,introduction:u,avatar:w,cover:f,followingCount:p,followerCount:h,isFollowing:v,tweetsCount:m},t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log("error",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},fetchUserFollowing:function(e){var o=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d["a"].getUserFollowings(e);case 3:n=t.sent,o.followships=Object(l["a"])(n.data),console.log("this following",o.followships),o.followships.length<1&&h["a"].fire({icon:"info",title:"這個人沒有追蹤任何人"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log("error",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},isThisMe:function(e){this.isMe=this.currentUser.id==e},addFollow:function(e){var o=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log(e),t.next=4,v["a"].addFollow({id:e});case 4:o.followships=o.followships.map((function(o){return o.followingId===e?Object(a["a"])(Object(a["a"])({},o),{},{isFollowed:!0}):o})),o.forceRenderFollowTop(),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),h["a"].fire({icon:"error",title:"無法follow此人，請稍後再試"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},unFollow:function(e){var o=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log(e),t.next=4,v["a"].unFollow({followingId:e});case 4:o.followships=o.followships.map((function(o){return o.followingId===e?Object(a["a"])(Object(a["a"])({},o),{},{isFollowed:!1}):o})),o.forceRenderFollowTop(),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),h["a"].fire({icon:"error",title:"無法unFollow此人，請稍後再試"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},forceRenderFollowTop:function(){this.componentKey+=1},addFollowFromfollowTop:function(e){if(console.log("payload",e),console.log("avatar",e.avatar),this.$route.params.id==this.currentUser.id)this.followships.push({followingId:e.id,followingUser:{id:e.id,name:e.name,account:e.account,avatar:e.avatar,introduction:e.introduction},isFollowed:!0}),console.log(this.followships);else{var o=this.followships.find((function(o){return o.followingId===e.id}));o&&(this.followships=this.followships.map((function(o){return o.followingId===e.id?(console.log("user",o),Object(a["a"])(Object(a["a"])({},o),{},{isFollowed:!0})):o})))}},unFollowFromfollowTop:function(e){console.log(e)}},computed:Object(a["a"])({},Object(p["b"])(["currentUser"])),created:function(){var e=localStorage.getItem("token");e||(h["a"].fire({icon:"warning",title:"請登入"}),this.$router.push("/login"));var o=this.$route.params.id;this.fetchUser(o),this.fetchUserFollowing(o),this.isThisMe(o)},watch:{"$route.params.id":{handler:function(e){this.fetchUser(e),this.fetchUserFollowing(e),this.isThisMe(e)},immediate:!0}},mixins:[f["b"],f["a"]]},g=m,b=(t("ea4c"),t("b30c"),t("2877")),F=Object(b["a"])(g,n,r,!1,null,"a3c5fa58",null);o["default"]=F.exports}}]);
//# sourceMappingURL=chunk-e4f5096e.2fde44af.js.map